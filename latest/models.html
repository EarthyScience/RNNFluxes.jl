<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Available Models · RNNFluxes.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>RNNFluxes.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="quickstart.html">A quick Overview</a></li><li class="current"><a class="toctext" href="models.html">Available Models</a><ul class="internal"><li><a class="toctext" href="#Recurrent-models-with-hand-coded-gradients-1">Recurrent models with hand-coded gradients</a></li><li><a class="toctext" href="#Trainning-a-generic-model-using-AutoDiff-1">Trainning a generic model using AutoDiff</a></li></ul></li><li><a class="toctext" href="training.html">Training and predicting models</a></li><li><a class="toctext" href="example_lossfunctions.html">Example loss functions</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href="models.html">Available Models</a></li></ul><a class="edit-page" href="https://github.com/bgi-jena/RNNFluxes.jl/blob/master/docs/src/models.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Available Models</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Available-Models-1" href="#Available-Models-1">Available Models</a></h1><h2><a class="nav-anchor" id="Recurrent-models-with-hand-coded-gradients-1" href="#Recurrent-models-with-hand-coded-gradients-1">Recurrent models with hand-coded gradients</a></h2><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RNNFluxes.LSTMModel" href="#RNNFluxes.LSTMModel"><code>RNNFluxes.LSTMModel</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">type LSTMModel</code></pre><p>Implementation of an LSTM with handcoded gradients. It has the following constructor:</p><pre><code class="language-none">LSTMModel(nVar,nHid; dist = Uniform, forgetBias = 1, nDropout=nHid ÷ 10)</code></pre><p><strong>Parameters</strong></p><ul><li><p><code>nVar</code> number of input (predictor) variables for each time step</p></li><li><p><code>nHid</code> number of hidden nodes contained in the LSTM</p></li><li><p><code>dist</code> distribution to generate initial Weights, currently <code>Uniform</code> and <code>Normal</code> are supported, defaults to <code>Uniform</code></p></li><li><p><code>forgetBias</code> determine bias of generating forget bias weights, defaults to 1</p></li><li><p><code>nDropOut</code> number of dropout nodes for each prediction, defaults to 10% of the nodes</p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/bgi-jena/RNNFluxes.jl/blob/04a14bc19446e23dda296579fda5c73d8d8df137/src/LSTM.jl#L4-L18">source</a></section><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RNNFluxes.RNNModel" href="#RNNFluxes.RNNModel"><code>RNNFluxes.RNNModel</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">type RNN</code></pre><p>Implementation of an RNN with handcoded gradients.</p><pre><code class="language-none">RNNModel(nVar,nHid;dist=Uniform)</code></pre><p><strong>Parameters</strong></p><ul><li><p><code>nVar</code> number of input (predictor) variables for each time step</p></li><li><p><code>nHid</code> number of hidden nodes contained in the RNN</p></li><li><p><code>dist</code> distribution to generate initial Weights, currently <code>Uniform</code> and <code>Normal</code> are supported, defaults to <code>Uniform</code></p></li></ul></div><a class="source-link" target="_blank" href="https://github.com/bgi-jena/RNNFluxes.jl/blob/04a14bc19446e23dda296579fda5c73d8d8df137/src/RNN.jl#L1-L13">source</a></section><h2><a class="nav-anchor" id="Trainning-a-generic-model-using-AutoDiff-1" href="#Trainning-a-generic-model-using-AutoDiff-1">Trainning a generic model using AutoDiff</a></h2><p>We have also wrapped the training and plotting machinery here together with the ForwardDiff package, so that you can invert any custom model, too. Please note that, for this prupose the package (Flux.jl)[https://github.com/FluxML/Flux.jl] might be a better and well-maintained option.  </p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="RNNFluxes.GenericModel" href="#RNNFluxes.GenericModel"><code>RNNFluxes.GenericModel</code></a> — <span class="docstring-category">Type</span>.</div><div><pre><code class="language-none">type GenericModel</code></pre><p>Type wrapping a generic model that is differentiated with AutoGrad. Only a predict function is needed.</p></div><a class="source-link" target="_blank" href="https://github.com/bgi-jena/RNNFluxes.jl/blob/04a14bc19446e23dda296579fda5c73d8d8df137/src/Generic.jl#L9-L13">source</a></section><p>A short example on how to define and train such a generic model follows. Let&#39;s assume we already know the model structure but want to estimate the parameters. Any Julia code would be valid here in defining this model:</p><pre><code class="language-julia">function my_generic_model{T}(model,w::AbstractArray{T},x)

    a = w[1]
    b = w[2]
    c = w[3]

    map(x) do ix
        cumsum(a * ix[1,:])+exp.(b * ix[2,:])+cumprod(c * ix[3,:])
    end
end</code></pre><p>We generate some artificial data again:</p><pre><code class="language-julia">nTime=100
nSample=200
nVarX = 3
x = [rand(nVarX,nTime) for i=1:nSample]

true_model(x) = transpose(cumsum(x[1,:])+exp.(x[2,:])+cumprod(1.7*x[3,:]))

y = true_model.(x);</code></pre><p>In the next step we define a <code>GenericModel</code> which includes our above-mentioned predict function.</p><pre><code class="language-julia">params = ()
w      = rand(3) #Init weights
m      = RNNFluxes.GenericModel(params,w,my_ANN_model)</code></pre><p>Training works &quot;as usual&quot;</p><pre><code class="language-julia">t = train_net(m,x,y,4001);</code></pre><footer><hr/><a class="previous" href="quickstart.html"><span class="direction">Previous</span><span class="title">A quick Overview</span></a><a class="next" href="training.html"><span class="direction">Next</span><span class="title">Training and predicting models</span></a></footer></article></body></html>
